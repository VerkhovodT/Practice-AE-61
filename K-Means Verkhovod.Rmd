---
title: "K-Means Verkhovod"
output:
  word_document: default
  html_notebook: default
  html_document: default
---

# Download the data
```{r}
set.seed(123)
setwd('D:/EP-61/R/')
f <- read.csv2('clients.csv', header = TRUE, encoding = 'UNICOD')
f <- f[, c('CLIENT_TOGETHER.INCOME', 'LOAN_OUTSTANDINGLOANSCOUNT')]
head(f)
```

Висновок: для побудови моделі кластеризації використано дані про наявність прострочених платежів по кредиту. Залишимо для моделювання лише кількісні змінні. Датасет не потребує розподілу на навчальну та тестову вибірки, не потребує шкалювання.

# Elbow method to find optimal number of clusters 
```{r}
library(stats) 
wcss = vector() 
for (i in 1:10) wcss[i] = sum(kmeans(f, i)$withinss) 
plot(1:10, 
     wcss, 
     type = 'b', 
     main = paste('The Elbow Method'), 
     xlab = 'Number of clusters', 
     ylab = 'WCSS')
```

Висновок: з використанням метода ліктя зроблено висновок про доцільність виявлення трьох кластерів.

# Fitting K-Means to the dataset
```{r}
set.seed(29)
model_km = kmeans(f, 3)
#cluster cores
y_km = model_km$cluster
aggregate(f,by=list(y_km),FUN=mean)
```

Висновок: на основі аналізу дендрограми виявлено три кластера: 2 – “кредит для тих у кого малий дохід та мало виданих кредитів”, 1 – “кредит для тих у кого середній дохід та середня кількість виданих кредитів”, 3 – “кредит для тих у кого високий рінень доходу та багато виданих кредитів”. Розраховано характеристики типового об’єкту кластерів. 

# Visualising the clusters
```{r}
library(cluster)
clusplot(f[,c('CLIENT_TOGETHER.INCOME', 'LOAN_OUTSTANDINGLOANSCOUNT')],
         y_km,
         lines = 0,
         shade = TRUE,
         color = TRUE,
         labels= 0,
         plotchar = FALSE,
         span = TRUE,
         main = paste('Clusters of customers'),
         xlab = 'CLIENT_TOGETHER.INCOME',
         ylab = 'LOAN_OUTSTANDINGLOANSCOUNT')
```

Висновок: проведено візуалізацію кластерів на датасеті.
